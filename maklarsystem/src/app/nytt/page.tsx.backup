'use client'

import { useState, useEffect, useRef } from 'react'
import { useRouter } from 'next/navigation'
import DashboardLayout from '@/components/layout/DashboardLayout'
import { ArrowLeft, Save, Upload, MapPin, Home, DollarSign, Users, FileText, Camera, Building, ChevronDown } from 'lucide-react'
import Link from 'next/link'
import { useCreateObjekt } from '@/lib/api/objekt'
import { useKontakter } from '@/lib/api/kontakter'
import { toast } from 'sonner'
import * as Select from '@radix-ui/react-select'

// Glass Card Component
const GlassCard = ({ children, className = "" }: { children: React.ReactNode; className?: string }) => (
  <div className={`backdrop-blur-xl bg-white/20 rounded-3xl border border-white/30 shadow-xl ${className}`}>
    {children}
  </div>
)

// Floating Background
const FloatingElements = () => (
  <div className="absolute inset-0 overflow-hidden pointer-events-none">
    <div className="absolute top-20 left-20 w-40 h-40 bg-gradient-to-br from-blue-200/20 to-purple-200/20 rounded-full blur-2xl animate-pulse"></div>
    <div className="absolute bottom-40 right-40 w-56 h-56 bg-gradient-to-br from-green-200/20 to-blue-200/20 rounded-full blur-3xl animate-pulse" style={{ animationDelay: '1s' }}></div>
  </div>
)

// Sticky Sidebar Navigation Component
const StickyNavigation = ({ activeSection, onSectionClick }: { activeSection: string; onSectionClick: (section: string) => void }) => {
  const sections = [
    { id: 'oversikt', label: '√ñVERSIKT', icon: 'üìã' },
    { id: 'beskrivningar', label: 'BESKRIVNINGAR', icon: 'üìù' },
    { id: 'spekulanter', label: 'SPEKULANTER', icon: 'üë•' },
    { id: 'dokument', label: 'DOKUMENT', icon: 'üìÑ' },
    { id: 'parter', label: 'PARTER', icon: 'ü§ù' },
    { id: 'affaren', label: 'AFF√ÑREN', icon: 'üíº' },
    { id: 'bilder', label: 'BILDER', icon: 'üì∑' },
    { id: 'foreningen', label: 'F√ñRENINGEN', icon: 'üè¢' },
    { id: 'marknadsf√∂ring', label: 'MARKNADSF√ñRING', icon: 'üì¢' },
    { id: 'tj√§nster', label: 'TJ√ÑNSTER', icon: '‚öôÔ∏è' },
    { id: 'l√•n-och-pant', label: 'L√ÖN OCH PANT', icon: 'üè¶' },
    { id: 'att-g√∂ra', label: 'ATT G√ñRA', icon: '‚úÖ' }
  ]

  return (
    <div className="w-72 flex-shrink-0">
      <div className="sticky top-24 w-72 h-[calc(100vh-8rem)] overflow-y-auto z-20">
        <div className="backdrop-blur-xl bg-white/30 border border-white/20 rounded-2xl shadow-lg p-4 h-full">
          <h3 className="text-lg font-semibold text-gray-800 mb-4">Navigering</h3>
          <div className="space-y-2 overflow-y-auto h-[calc(100%-4rem)]">
            {sections.map((section) => (
              <button
                key={section.id}
                onClick={() => onSectionClick(section.id)}
                className={`w-full flex items-center space-x-3 px-4 py-3 rounded-xl transition-all duration-200 text-left ${
                  activeSection === section.id
                    ? 'bg-blue-500/20 text-blue-700 border border-blue-300/30'
                    : 'hover:bg-white/20 text-gray-700'
                }`}
              >
                <span className="text-xl">{section.icon}</span>
                <span className="text-sm font-medium">{section.label}</span>
              </button>
            ))}
          </div>
        </div>
      </div>
    </div>
  )
}

export default function NyttObjektPage() {
  const router = useRouter()
  const createObjekt = useCreateObjekt()
  const { data: kontakter = [] } = useKontakter()
  const [activeSection, setActiveSection] = useState('oversikt')
  
  // Section refs for smooth scrolling
  const sectionRefs = useRef<{[key: string]: HTMLDivElement | null}>({})
  
  const [formData, setFormData] = useState({
    // Grundl√§ggande information
    typ: 'lagenhet' as 'villa' | 'lagenhet' | 'radhus' | 'fritidshus' | 'tomt',
    status: 'kundbearbetning' as 'kundbearbetning' | 'uppdrag' | 'till_salu' | 'sald' | 'tilltraden',
    
    // √Ñgare och klassificering
    agare_id: '',
    agare_typ: 'privatperson' as 'privatperson' | 'foretag' | 'kommun' | 'stat',
    agandekategori: 'bostadsratt' as 'agt' | 'bostadsratt' | 'hyresratt' | 'arrende',
    
    // Adress
    adress: '',
    postnummer: '',
    ort: '',
    kommun: 'Stockholm',
    lan: '',
    latitude: '',
    longitude: '',
    
    // New fields for Grundinformation form
    fastighetsbeteckning: '',
    lagenhetsnummer_forening: '',
    lagenhetsnummer_register: '',
    portkod: '',
    nycklnummer: '',
    arkivnummer: '',
    ovrigt: '',
    utokade_sokbegrepp: '',
    nyproduktion: false,
    omrade: '',
    
    // Ut√∂kad priss√§ttning och budgivning
    utgangspris: '',
    accepterat_pris: '',
    slutpris: '',
    budgivning: false,
    budgivningsdatum: '',
    pristyp: 'fast' as 'fast' | 'forhandling' | 'budgivning',
    prisutveckling: '',
    
    // Detaljerade m√•nadsavgifter och kostnader
    manadsavgift: '',
    avgift_innefattar: '',
    kapitaltillskott: '',
    energikostnad_per_ar: '',
    drift_per_kvm: '',
    
    // Befintliga ekonomiska f√§lt
    pantbrev: '',
    taxeringsvarde: '',
    kommunala_avgifter: '',
    forsakringskostnad: '',
    reparationsfond: '',
    driftkostnad: '',
    avgift: '',
    elforbrukning: '',
    vattenforbrukning: '',
    uppvarmningskostnad: '',
    
    // Ut√∂kad rumslayout
    boarea: '',
    biarea: '',
    tomtarea: '',
    kallare_area: '',
    garage_area: '',
    rum: '',
    antal_sovrum: '',
    antal_wc: '',
    antal_vaningar_hus: '',
    koksstorlek: '',
    vardagsrumsstorlek: '',
    byggaar: '',
    vaning: '',
    
    // K√∂k och badrum
    kok: '' as '' | 'kokso' | 'halvoppet' | 'oppet' | 'kokonk' | 'modernt' | 'renoverat' | 'originalskick',
    badrum_antal: '',
    
    // Ut√∂kade bekv√§mligheter
    balkong_terrass: false,
    hiss: false,
    garage: '',
    carport: false,
    forrad: false,
    tradgard: false,
    pool: false,
    bastu: false,
    kamin: false,
    vinkallare: false,
    hobbyrum: false,
    antal_parkeringsplatser: '',
    
    // Energicertifiering
    energiklass: '' as '' | 'A' | 'B' | 'C' | 'D' | 'E' | 'F' | 'G',
    energiprestanda: '',
    energicertifikat_nummer: '',
    energicertifikat_utfardad: '',
    energicertifikat_giltig_till: '',
    
    // Personer
    saljare_id: '',
    kopare_id: '',
    
    // Ut√∂kade beskrivningar
    beskrivning: '',
    maklartext: '',
    salutext: '',
    marknadsforingstext: '',
    
    // Tillbeh√∂r
    tillbehor_som_ingaar: '',
    tillbehor_som_ej_ingaar: '',
    
    // Tekniska detaljer - byggnad
    byggmaterial: '' as '' | 'tegel' | 'trak' | 'betong' | 'puts' | 'panel' | 'natursten' | 'annat',
    taktyp: '' as '' | 'tegeltak' | 'platt' | 'betongpannor' | 'sadeltak' | 'mansardtak' | 'pulpettak' | 'annat',
    fasadmaterial: '' as '' | 'tegel' | 'puts' | 'trak' | 'panel' | 'natursten' | 'betong' | 'eternit' | 'annat',
    fonstertyp: '' as '' | 'treglas' | 'tvaglas' | 'traglas_argon' | 'aluminiumkarmar' | 'trakarmar' | 'plastkarmar',
    isolering: '' as '' | 'mineralull' | 'cellulosa' | 'polyuretan' | 'eps' | 'xps' | 'annat',
    
    // Tekniska detaljer - installationer
    uppvarmning: '' as '' | 'fj√§rrv√§rme' | 'elv√§rme' | 'pelletsbr√§nnare' | 'vedeldning' | 'olja' | 'gas' | 'bergv√§rme' | 'luftv√§rmepump' | 'annat',
    ventilation: '' as '' | 'mekanisk_til_och_franluft' | 'mekanisk_franluft' | 'naturlig' | 'balanserad' | 'fr√•nluft',
    elnat: '' as '' | 'trefas' | 'enfas' | 'trefas_16A' | 'trefas_25A' | 'trefas_35A',
    vatten_avlopp: '',
    
    // S√§kerhet och system
    brandskydd: '',
    larm: '',
    bredband: '' as '' | 'fiber' | 'adsl' | 'kabel' | 'mobilt' | 'satellit' | 'inte_tillgangligt',
    kabel_tv: false,
    internet: '',
    
    // Milj√∂ och omgivning
    narmaste_skola: '',
    narmaste_vardcentral: '',
    narmaste_dagis: '',
    avstand_centrum: '',
    havsnara: false,
    sjonara: false,
    skogsnara: false,
    
    // Transport och parkering
    kollektivtrafik: '',
    parkering: '',
    
    // Renovering och historik
    bygglov: '',
    senaste_renovering: '',
    planerad_renovering: '',
    
    // Juridiska aspekter
    servitut: '',
    inskrankning: '',
    belastningar: '',
    gemensamhetsanlaggning: '',
    
    // Visning och marknadsf√∂ring
    tillgangsdatum: '',
    visningsinfo: '',
    visningsdagar: '',
    oppet_hus: '',
    visningsdagar_detaljer: '',
    oppet_hus_detaljer: '',
    
    // Tidslinje och status
    listningsdatum: '',
    avtal_datum: '',
    tilltraden_datum: '',
    
    // Dokument
    planritning_url: '',
    energideklaration_url: '',
    byggnadsbeskrivning_url: '',
    
    // √ñvrigt
    specialbestammelser: '',
    anmarkningar: ''
  })

  // Handle smooth scrolling to sections
  const handleSectionClick = (sectionId: string) => {
    setActiveSection(sectionId)
    const element = sectionRefs.current[sectionId]
    if (element) {
      element.scrollIntoView({ 
        behavior: 'smooth',
        block: 'start'
      })
    }
  }

  // Track active section while scrolling
  useEffect(() => {
    const handleScroll = () => {
      const sections = Object.keys(sectionRefs.current)
      const scrollPosition = window.scrollY + 200 // Offset for sticky nav

      for (const sectionId of sections) {
        const element = sectionRefs.current[sectionId]
        if (element) {
          const { offsetTop, offsetHeight } = element
          if (scrollPosition >= offsetTop && scrollPosition < offsetTop + offsetHeight) {
            setActiveSection(sectionId)
            break
          }
        }
      }
    }

    window.addEventListener('scroll', handleScroll)
    return () => window.removeEventListener('scroll', handleScroll)
  }, [])

  const handleSubmit = (e: React.FormEvent) => {
    e.preventDefault()
    
    // For now, use the test user ID we created
    // In a real app, this would come from auth context
    const userId = '6a0af328-9be6-4dd9-ae83-ce2cf512da6d'
    
    createObjekt.mutate({
        // Basic info
        typ: formData.typ,
        status: formData.status,
        adress: formData.adress,
        postnummer: formData.postnummer,
        ort: formData.ort,
        kommun: formData.kommun,
        lan: formData.lan,
        
        // Ownership and classification
        agare_id: formData.agare_id || null,
        agare_typ: formData.agare_typ || null,
        agandekategori: formData.agandekategori || null,
        
        // Enhanced pricing and bidding
        utgangspris: formData.utgangspris ? parseFloat(formData.utgangspris) : null,
        accepterat_pris: formData.accepterat_pris ? parseFloat(formData.accepterat_pris) : null,
        slutpris: formData.slutpris ? parseFloat(formData.slutpris) : null,
        budgivning: formData.budgivning,
        budgivningsdatum: formData.budgivningsdatum || null,
        pristyp: formData.pristyp || null,
        prisutveckling: formData.prisutveckling || null,
        
        // Detailed monthly fees and costs
        manadsavgift: formData.manadsavgift ? parseInt(formData.manadsavgift) : null,
        avgift_innefattar: formData.avgift_innefattar || null,
        kapitaltillskott: formData.kapitaltillskott ? parseInt(formData.kapitaltillskott) : null,
        energikostnad_per_ar: formData.energikostnad_per_ar ? parseInt(formData.energikostnad_per_ar) : null,
        drift_per_kvm: formData.drift_per_kvm ? parseInt(formData.drift_per_kvm) : null,
        
        // Enhanced room layout
        boarea: formData.boarea ? parseInt(formData.boarea) : null,
        biarea: formData.biarea ? parseInt(formData.biarea) : null,
        tomtarea: formData.tomtarea ? parseInt(formData.tomtarea) : null,
        kallare_area: formData.kallare_area ? parseInt(formData.kallare_area) : null,
        garage_area: formData.garage_area ? parseInt(formData.garage_area) : null,
        rum: formData.rum ? parseInt(formData.rum) : null,
        antal_sovrum: formData.antal_sovrum ? parseInt(formData.antal_sovrum) : null,
        antal_wc: formData.antal_wc ? parseInt(formData.antal_wc) : null,
        antal_vaningar_hus: formData.antal_vaningar_hus ? parseInt(formData.antal_vaningar_hus) : null,
        koksstorlek: formData.koksstorlek ? parseInt(formData.koksstorlek) : null,
        vardagsrumsstorlek: formData.vardagsrumsstorlek ? parseInt(formData.vardagsrumsstorlek) : null,
        byggaar: formData.byggaar ? parseInt(formData.byggaar) : null,
        vaning: formData.vaning ? parseInt(formData.vaning) : null,
        
        // Energy certification
        energiklass: formData.energiklass || null,
        energiprestanda: formData.energiprestanda ? parseInt(formData.energiprestanda) : null,
        energicertifikat_nummer: formData.energicertifikat_nummer || null,
        energicertifikat_utfardad: formData.energicertifikat_utfardad || null,
        energicertifikat_giltig_till: formData.energicertifikat_giltig_till || null,
        
        // Enhanced amenities
        vinkallare: formData.vinkallare,
        hobbyrum: formData.hobbyrum,
        carport: formData.carport,
        bastu: formData.bastu,
        antal_parkeringsplatser: formData.antal_parkeringsplatser ? parseInt(formData.antal_parkeringsplatser) : null,
        
        // Kitchen and bathrooms
        kok: formData.kok || null,
        badrum_antal: formData.badrum_antal ? parseInt(formData.badrum_antal) : null,
        
        // Features (existing)
        balkong_terrass: formData.balkong_terrass,
        hiss: formData.hiss,
        garage: formData.garage || null,
        forrad: formData.forrad,
        tradgard: formData.tradgard,
        pool: formData.pool,
        kamin: formData.kamin,
        
        // People
        maklare_id: userId,
        saljare_id: formData.saljare_id && formData.saljare_id !== 'none' ? formData.saljare_id : null,
        kopare_id: formData.kopare_id || null,
        
        // Enhanced descriptions
        beskrivning: formData.beskrivning || null,
        maklartext: formData.maklartext || null,
        salutext: formData.salutext || null,
        marknadsforingstext: formData.marknadsforingstext || null,
        
        // What's included/excluded
        tillbehor_som_ingaar: formData.tillbehor_som_ingaar || null,
        tillbehor_som_ej_ingaar: formData.tillbehor_som_ej_ingaar || null,
        
        // Legal aspects
        servitut: formData.servitut || null,
        inskrankning: formData.inskrankning || null,
        belastningar: formData.belastningar || null,
        gemensamhetsanlaggning: formData.gemensamhetsanlaggning || null,
        planerad_renovering: formData.planerad_renovering || null,
        
        // Enhanced location data
        latitude: formData.latitude ? parseFloat(formData.latitude) : null,
        longitude: formData.longitude ? parseFloat(formData.longitude) : null,
        
        // Document references
        planritning_url: formData.planritning_url || null,
        energideklaration_url: formData.energideklaration_url || null,
        byggnadsbeskrivning_url: formData.byggnadsbeskrivning_url || null,
        
        // Timeline and status tracking
        listningsdatum: formData.listningsdatum || null,
        avtal_datum: formData.avtal_datum || null,
        tilltraden_datum: formData.tilltraden_datum || null,
        
        // Costs (existing)
        driftkostnad: formData.driftkostnad ? parseInt(formData.driftkostnad) : null,
        avgift: formData.avgift ? parseInt(formData.avgift) : null,
        pantbrev: formData.pantbrev ? parseInt(formData.pantbrev) : null,
        taxeringsvarde: formData.taxeringsvarde ? parseInt(formData.taxeringsvarde) : null,
        kommunala_avgifter: formData.kommunala_avgifter ? parseInt(formData.kommunala_avgifter) : null,
        forsakringskostnad: formData.forsakringskostnad ? parseInt(formData.forsakringskostnad) : null,
        reparationsfond: formData.reparationsfond ? parseInt(formData.reparationsfond) : null,
        elforbrukning: formData.elforbrukning ? parseInt(formData.elforbrukning) : null,
        vattenforbrukning: formData.vattenforbrukning ? parseInt(formData.vattenforbrukning) : null,
        uppvarmningskostnad: formData.uppvarmningskostnad ? parseInt(formData.uppvarmningskostnad) : null,
        
        // Technical details (existing)
        byggmaterial: formData.byggmaterial || null,
        taktyp: formData.taktyp || null,
        fasadmaterial: formData.fasadmaterial || null,
        fonstertyp: formData.fonstertyp || null,
        isolering: formData.isolering || null,
        uppvarmning: formData.uppvarmning || null,
        ventilation: formData.ventilation || null,
        elnat: formData.elnat || null,
        vatten_avlopp: formData.vatten_avlopp || null,
        
        // Security and systems (existing)
        brandskydd: formData.brandskydd || null,
        larm: formData.larm || null,
        bredband: formData.bredband || null,
        kabel_tv: formData.kabel_tv,
        internet: formData.internet || null,
        
        // Environment (existing)
        narmaste_skola: formData.narmaste_skola || null,
        narmaste_vardcentral: formData.narmaste_vardcentral || null,
        narmaste_dagis: formData.narmaste_dagis || null,
        avstand_centrum: formData.avstand_centrum ? parseInt(formData.avstand_centrum) : null,
        havsnara: formData.havsnara,
        sjonara: formData.sjonara,
        skogsnara: formData.skogsnara,
        
        // Transport (existing)
        kollektivtrafik: formData.kollektivtrafik || null,
        parkering: formData.parkering || null,
        
        // Building history (existing)
        bygglov: formData.bygglov || null,
        senaste_renovering: formData.senaste_renovering || null,
        
        // Availability and showings
        tillgangsdatum: formData.tillgangsdatum || null,
        visningsinfo: formData.visningsinfo || null,
        visningsdagar: formData.visningsdagar || null,
        oppet_hus: formData.oppet_hus || null,
        visningsdagar_detaljer: formData.visningsdagar_detaljer || null,
        oppet_hus_detaljer: formData.oppet_hus_detaljer || null,
        
        // Other
        specialbestammelser: formData.specialbestammelser || null,
        anmarkningar: formData.anmarkningar || null
      }, {
        onSuccess: () => {
          toast.success('Objekt skapat!')
          router.push('/objekt')
        },
        onError: (error) => {
          console.error('Error creating objekt:', error)
          toast.error('Kunde inte skapa objekt')
        }
      })
  }

  return (
    <DashboardLayout>
      <div className="min-h-screen bg-gradient-to-br from-blue-100 via-purple-50 to-green-100 relative overflow-hidden -m-6 p-6 pt-12">
        <FloatingElements />
        
        <div className="relative z-10 max-w-7xl mx-auto">
          {/* Header */}
          <GlassCard className="p-6 mb-6">
            <div className="flex items-center justify-between">
              <div className="flex items-center space-x-4">
                <Link href="/objekt" className="p-2 hover:bg-white/20 rounded-xl transition-all">
                  <ArrowLeft className="w-5 h-5 text-gray-600" />
                </Link>
                <div>
                  <h1 className="text-3xl font-light text-gray-800">Nytt objekt</h1>
                  <p className="text-gray-600">L√§gg till ett nytt fastighetsobjekt</p>
                </div>
              </div>
            </div>
          </GlassCard>

          {/* Main Layout with Sidebar and Content */}
          <div className="flex gap-6 relative">
            {/* Sticky Navigation Sidebar - Hidden on mobile */}
            <div className="hidden lg:block">
              <StickyNavigation activeSection={activeSection} onSectionClick={handleSectionClick} />
            </div>

            {/* Main Content */}
            <div className="flex-1 w-full lg:w-auto lg:pl-6 relative z-10">
              <form onSubmit={handleSubmit} className="space-y-6">
                {/* √ñversikt (Grundinformation) */}
                <div ref={(el) => { sectionRefs.current['oversikt'] = el }}>
                  <GlassCard className="p-8">
              <div className="mb-8">
                <h2 className="text-2xl font-light text-gray-800 mb-2">Grundinformation</h2>
                <div className="w-16 h-0.5 bg-gradient-to-r from-blue-500 to-purple-600"></div>
              </div>
              
              {/* Form Layout - Improved Compact Design */}
              <div className="space-y-6">
                {/* Address & Basic Info Section */}
                <div className="backdrop-blur-xl bg-white/30 border border-white/20 rounded-2xl p-6">
                  <h3 className="text-lg font-medium text-gray-800 mb-4 flex items-center">
                    <Home className="w-5 h-5 mr-2 text-blue-600" />
                    Adress & Grundinfo
                  </h3>
                  
                  <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-1">S√∂kbegrepp</label>
                      <Select.Root value={formData.typ} onValueChange={(value: any) => setFormData({...formData, typ: value})}>
                        <Select.Trigger className="w-full flex items-center justify-between backdrop-blur-xl bg-white/50 border border-white/30 px-3 py-2.5 rounded-xl font-medium text-gray-800 hover:bg-white/60 transition-all duration-200">
                          <Select.Value placeholder="V√§lj typ" />
                          <ChevronDown className="w-4 h-4" />
                        </Select.Trigger>
                        <Select.Portal>
                          <Select.Content className="backdrop-blur-xl bg-white/95 border border-gray-200 rounded-xl shadow-xl z-50">
                            <Select.Viewport className="p-2">
                              <Select.Item value="lagenhet" className="px-3 py-2 rounded-lg hover:bg-gray-100 cursor-pointer">
                                <Select.ItemText>L√§genhet</Select.ItemText>
                              </Select.Item>
                              <Select.Item value="villa" className="px-3 py-2 rounded-lg hover:bg-gray-100 cursor-pointer">
                                <Select.ItemText>Villa</Select.ItemText>
                              </Select.Item>
                              <Select.Item value="radhus" className="px-3 py-2 rounded-lg hover:bg-gray-100 cursor-pointer">
                                <Select.ItemText>Radhus</Select.ItemText>
                              </Select.Item>
                              <Select.Item value="fritidshus" className="px-3 py-2 rounded-lg hover:bg-gray-100 cursor-pointer">
                                <Select.ItemText>Fritidshus</Select.ItemText>
                              </Select.Item>
                              <Select.Item value="tomt" className="px-3 py-2 rounded-lg hover:bg-gray-100 cursor-pointer">
                                <Select.ItemText>Tomt</Select.ItemText>
                              </Select.Item>
                            </Select.Viewport>
                          </Select.Content>
                        </Select.Portal>
                      </Select.Root>
                    </div>

                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-1">Uppl√•telseform</label>
                      <Select.Root value={formData.agandekategori} onValueChange={(value: any) => setFormData({...formData, agandekategori: value})}>
                        <Select.Trigger className="w-full flex items-center justify-between backdrop-blur-xl bg-white/50 border border-white/30 px-3 py-2.5 rounded-xl font-medium text-gray-800 hover:bg-white/60 transition-all duration-200">
                          <Select.Value placeholder="Bostadsr√§tt" />
                          <ChevronDown className="w-4 h-4" />
                        </Select.Trigger>
                        <Select.Portal>
                          <Select.Content className="backdrop-blur-xl bg-white/95 border border-gray-200 rounded-xl shadow-xl z-50">
                            <Select.Viewport className="p-2">
                              <Select.Item value="bostadsratt" className="px-3 py-2 rounded-lg hover:bg-gray-100 cursor-pointer">
                                <Select.ItemText>Bostadsr√§tt</Select.ItemText>
                              </Select.Item>
                              <Select.Item value="agt" className="px-3 py-2 rounded-lg hover:bg-gray-100 cursor-pointer">
                                <Select.ItemText>√Ñgander√§tt</Select.ItemText>
                              </Select.Item>
                              <Select.Item value="hyresratt" className="px-3 py-2 rounded-lg hover:bg-gray-100 cursor-pointer">
                                <Select.ItemText>Hyresr√§tt</Select.ItemText>
                              </Select.Item>
                              <Select.Item value="arrende" className="px-3 py-2 rounded-lg hover:bg-gray-100 cursor-pointer">
                                <Select.ItemText>Arrende</Select.ItemText>
                              </Select.Item>
                            </Select.Viewport>
                          </Select.Content>
                        </Select.Portal>
                      </Select.Root>
                    </div>

                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-1">Nyproduktion</label>
                      <div className="flex items-center space-x-3 py-2">
                        <button
                          type="button"
                          onClick={() => setFormData({...formData, nyproduktion: !formData.nyproduktion})}
                          className={`relative inline-flex h-5 w-9 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ${
                            formData.nyproduktion ? 'bg-blue-600' : 'bg-gray-300'
                          }`}
                        >
                          <span
                            className={`inline-block h-3 w-3 transform rounded-full bg-white transition-transform ${
                              formData.nyproduktion ? 'translate-x-5' : 'translate-x-1'
                            }`}
                          />
                        </button>
                        <span className="text-sm text-gray-600">
                          {formData.nyproduktion ? 'Ja' : 'Nej'}
                        </span>
                      </div>
                    </div>

                    <div className="md:col-span-2">
                      <label className="block text-sm font-medium text-gray-700 mb-1">Gatuadress</label>
                      <input
                        type="text"
                        value={formData.adress}
                        onChange={(e) => setFormData({...formData, adress: e.target.value})}
                        className="w-full backdrop-blur-xl bg-white/50 border border-white/30 px-3 py-2.5 rounded-xl text-gray-800 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                        placeholder="Ange gatuadress"
                      />
                    </div>
                  </div>

                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-1">Postnummer</label>
                      <input
                        type="text"
                        value={formData.postnummer}
                        onChange={(e) => setFormData({...formData, postnummer: e.target.value})}
                        className="w-full backdrop-blur-xl bg-white/50 border border-white/30 px-3 py-2.5 rounded-xl text-gray-800 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                        placeholder="12345"
                      />
                    </div>

                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-1">Ort</label>
                      <input
                        type="text"
                        value={formData.ort}
                        onChange={(e) => setFormData({...formData, ort: e.target.value})}
                        className="w-full backdrop-blur-xl bg-white/50 border border-white/30 px-3 py-2.5 rounded-xl text-gray-800 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                        placeholder="Ange ort"
                      />
                    </div>

                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-1">Omr√•de</label>
                      <input
                        type="text"
                        value={formData.omrade || ''}
                        onChange={(e) => setFormData({...formData, omrade: e.target.value})}
                        className="w-full backdrop-blur-xl bg-white/50 border border-white/30 px-3 py-2.5 rounded-xl text-gray-800 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                        placeholder="Ange omr√•de"
                      />
                    </div>

                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-1">Kommun</label>
                      <input
                        type="text"
                        value={formData.kommun}
                        onChange={(e) => setFormData({...formData, kommun: e.target.value})}
                        className="w-full backdrop-blur-xl bg-white/50 border border-white/30 px-3 py-2.5 rounded-xl text-gray-800 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                        placeholder="Stockholm"
                      />
                    </div>
                  </div>
                </div>

                {/* Property Details Section */}
                <div className="backdrop-blur-xl bg-white/30 border border-white/20 rounded-2xl p-6">
                  <h3 className="text-lg font-medium text-gray-800 mb-4 flex items-center">
                    <FileText className="w-5 h-5 mr-2 text-green-600" />
                    Fastighetsdetaljer
                  </h3>
                  
                  <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-1">Fastighetsbeteckning</label>
                        <input
                          type="text"
                          value={formData.fastighetsbeteckning || ''}
                          onChange={(e) => setFormData({...formData, fastighetsbeteckning: e.target.value})}
                          className="w-full backdrop-blur-xl bg-white/50 border border-white/30 px-3 py-2.5 rounded-xl text-gray-800 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                          placeholder="Ange fastighetsbeteckning"
                        />
                      </div>
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-1">L√§genhetsnummer f√∂rening</label>
                        <input
                          type="text"
                          value={formData.lagenhetsnummer_forening || ''}
                          onChange={(e) => setFormData({...formData, lagenhetsnummer_forening: e.target.value})}
                          className="w-full backdrop-blur-xl bg-white/50 border border-white/30 px-3 py-2.5 rounded-xl text-gray-800 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                          placeholder="L√§genhetsnummer register"
                        />
                      </div>

                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-1">L√§genhetsnummer register</label>
                        <input
                          type="text"
                          value={formData.lagenhetsnummer_register || ''}
                          onChange={(e) => setFormData({...formData, lagenhetsnummer_register: e.target.value})}
                          className="w-full backdrop-blur-xl bg-white/50 border border-white/30 px-3 py-2.5 rounded-xl text-gray-800 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                          placeholder="L√§genhetsnummer register"
                        />
                      </div>

                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-1">Nycklnummer</label>
                        <input
                          type="text"
                          value={formData.nycklnummer || ''}
                          onChange={(e) => setFormData({...formData, nycklnummer: e.target.value})}
                          className="w-full backdrop-blur-xl bg-white/50 border border-white/30 px-3 py-2.5 rounded-xl text-gray-800 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                          placeholder="Nycklnummer"
                        />
                      </div>

                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-1">Portkod</label>
                        <input
                          type="text"
                          value={formData.portkod || ''}
                          onChange={(e) => setFormData({...formData, portkod: e.target.value})}
                          className="w-full backdrop-blur-xl bg-white/50 border border-white/30 px-3 py-2.5 rounded-xl text-gray-800 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                          placeholder="Portkod"
                        />
                      </div>

                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-1">Arkivnummer</label>
                        <input
                          type="text"
                          value={formData.arkivnummer || ''}
                          onChange={(e) => setFormData({...formData, arkivnummer: e.target.value})}
                          className="w-full backdrop-blur-xl bg-white/50 border border-white/30 px-3 py-2.5 rounded-xl text-gray-800 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                          placeholder="Ange arkivnummer"
                        />
                      </div>

                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-1">Ut√∂kade s√∂kbegrepp</label>
                        <input
                          type="text"
                          value={formData.utokade_sokbegrepp || ''}
                          onChange={(e) => setFormData({...formData, utokade_sokbegrepp: e.target.value})}
                          className="w-full backdrop-blur-xl bg-white/50 border border-white/30 px-3 py-2.5 rounded-xl text-gray-800 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                          placeholder="Ut√∂kade s√∂kbegrepp"
                        />
                      </div>

                      <div className="md:col-span-2">
                        <label className="block text-sm font-medium text-gray-700 mb-1">√ñvrigt</label>
                        <textarea
                          value={formData.ovrigt || ''}
                          onChange={(e) => setFormData({...formData, ovrigt: e.target.value})}
                          rows={2}
                          className="w-full backdrop-blur-xl bg-white/50 border border-white/30 px-3 py-2.5 rounded-xl text-gray-800 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 resize-none"
                          placeholder="√ñvrig information"
                        />
                      </div>
                    </div>
                  </div>

                  {/* Map & Location Section */}
                  <div className="backdrop-blur-xl bg-white/30 border border-white/20 rounded-2xl p-6">
                    <h3 className="text-lg font-medium text-gray-800 mb-4 flex items-center">
                      <MapPin className="w-5 h-5 mr-2 text-purple-600" />
                      Karta & Position
                    </h3>
                    
                    <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                      <div className="lg:col-span-2">
                        {/* Compact Map */}
                        <div className="relative h-48 bg-gradient-to-br from-yellow-100 via-green-100 to-green-200 rounded-xl overflow-hidden">
                          <div className="absolute inset-0 flex items-center justify-center">
                            <div className="relative">
                              <div className="w-24 h-36 bg-gradient-to-b from-green-400 to-green-600 rounded-tl-2xl rounded-tr-lg rounded-bl-xl rounded-br-lg transform rotate-12 opacity-80"></div>
                              <div className="absolute top-6 left-6 w-2 h-2 bg-red-500 rounded-full shadow-lg animate-pulse"></div>
                            </div>
                          </div>
                          
                          <div className="absolute top-3 right-3 flex space-x-1">
                            <button type="button" className="w-6 h-6 bg-white/90 border border-gray-300 rounded-md flex items-center justify-center hover:bg-white transition-colors text-xs font-bold">+</button>
                            <button type="button" className="w-6 h-6 bg-white/90 border border-gray-300 rounded-md flex items-center justify-center hover:bg-white transition-colors text-xs font-bold">‚àí</button>
                          </div>
                          
                          <div className="absolute top-3 left-3 bg-white/95 rounded-lg p-2 space-y-1">
                            <label className="flex items-center space-x-1 text-xs">
                              <input type="radio" name="mapType" value="karta" defaultChecked className="w-2 h-2" />
                              <span>Karta</span>
                            </label>
                            <label className="flex items-center space-x-1 text-xs">
                              <input type="radio" name="mapType" value="satellit" className="w-2 h-2" />
                              <span>Satellit</span>
                            </label>
                          </div>
                          
                          <div className="absolute bottom-3 right-3 bg-white/95 rounded px-2 py-1 text-xs text-gray-600">
                            √ñsterg√∂tland
                          </div>
                        </div>
                      </div>
                      
                      <div className="space-y-4">
                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-1">Latitud</label>
                          <input
                            type="text"
                            value={formData.latitude}
                            onChange={(e) => setFormData({...formData, latitude: e.target.value})}
                            className="w-full backdrop-blur-xl bg-white/50 border border-white/30 px-3 py-2.5 rounded-xl text-gray-800 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                            placeholder="58.1234"
                          />
                        </div>
                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-1">Longitud</label>
                          <input
                            type="text"
                            value={formData.longitude}
                            onChange={(e) => setFormData({...formData, longitude: e.target.value})}
                            className="w-full backdrop-blur-xl bg-white/50 border border-white/30 px-3 py-2.5 rounded-xl text-gray-800 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                            placeholder="15.1234"
                          />
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
                  </GlassCard>
                </div>

                {/* BESKRIVNINGAR */}
                <div ref={(el) => { sectionRefs.current['beskrivningar'] = el }}>
              <GlassCard className="p-6">
                <div className="flex items-center space-x-3 mb-6">
                  <div className="w-10 h-10 bg-gradient-to-br from-green-500 to-teal-600 rounded-xl flex items-center justify-center">
                    <FileText className="w-5 h-5 text-white" />
                  </div>
                  <h2 className="text-xl font-semibold text-gray-800">Beskrivningar</h2>
                </div>
                <div className="space-y-4">
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Objektbeskrivning</label>
                    <textarea
                      value={formData.beskrivning || ''}
                      onChange={(e) => setFormData({...formData, beskrivning: e.target.value})}
                      rows={4}
                      className="w-full backdrop-blur-xl bg-white/30 border border-white/40 px-4 py-3 rounded-2xl resize-none"
                      placeholder="Beskriv objektet..."
                    />
                  </div>
                </div>
              </GlassCard>
            </div>

            {/* SPEKULANTER */}
            <div ref={(el) => { sectionRefs.current['spekulanter'] = el }}>
              <GlassCard className="p-6">
                <div className="flex items-center space-x-3 mb-6">
                  <div className="w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-600 rounded-xl flex items-center justify-center">
                    <Users className="w-5 h-5 text-white" />
                  </div>
                  <h2 className="text-xl font-semibold text-gray-800">Spekulanter</h2>
                </div>
                <div className="text-gray-600">
                  <p>Hantering av spekulanter kommer h√§r...</p>
                </div>
              </GlassCard>
            </div>

            {/* DOKUMENT */}
            <div ref={(el) => { sectionRefs.current['dokument'] = el }}>
              <GlassCard className="p-6">
                <div className="flex items-center space-x-3 mb-6">
                  <div className="w-10 h-10 bg-gradient-to-br from-yellow-500 to-orange-600 rounded-xl flex items-center justify-center">
                    <FileText className="w-5 h-5 text-white" />
                  </div>
                  <h2 className="text-xl font-semibold text-gray-800">Dokument</h2>
                </div>
                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Planritning URL</label>
                    <input
                      type="url"
                      value={formData.planritning_url || ''}
                      onChange={(e) => setFormData({...formData, planritning_url: e.target.value})}
                      className="w-full backdrop-blur-xl bg-white/30 border border-white/40 px-4 py-3 rounded-2xl"
                      placeholder="https://..."
                    />
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Energideklaration URL</label>
                    <input
                      type="url"
                      value={formData.energideklaration_url || ''}
                      onChange={(e) => setFormData({...formData, energideklaration_url: e.target.value})}
                      className="w-full backdrop-blur-xl bg-white/30 border border-white/40 px-4 py-3 rounded-2xl"
                      placeholder="https://..."
                    />
                  </div>
                </div>
              </GlassCard>
            </div>

            {/* PARTER */}
            <div ref={(el) => { sectionRefs.current['parter'] = el }}>
              <GlassCard className="p-6">
                <div className="flex items-center space-x-3 mb-6">
                  <div className="w-10 h-10 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center">
                    <Users className="w-5 h-5 text-white" />
                  </div>
                  <h2 className="text-xl font-semibold text-gray-800">Parter</h2>
                </div>
                <div className="text-gray-600">
                  <p>Hantering av parter (s√§ljare, k√∂pare, etc.) kommer h√§r...</p>
                </div>
              </GlassCard>
            </div>

            {/* AFF√ÑREN - Priss√§ttning och ekonomi */}
            <div ref={(el) => { sectionRefs.current['affaren'] = el }}>
            <GlassCard className="p-6">
              <div className="flex items-center space-x-3 mb-6">
                <div className="w-10 h-10 bg-gradient-to-br from-orange-500 to-red-600 rounded-xl flex items-center justify-center">
                  <DollarSign className="w-5 h-5 text-white" />
                </div>
                <h2 className="text-xl font-semibold text-gray-800">Priss√§ttning och budgivning</h2>
              </div>
              
              <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">Utg√•ngspris (kr)</label>
                  <input
                    type="number"
                    value={formData.utgangspris}
                    onChange={(e) => setFormData({...formData, utgangspris: e.target.value})}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500"
                  />
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">Accepterat pris (kr)</label>
                  <input
                    type="number"
                    value={formData.accepterat_pris}
                    onChange={(e) => setFormData({...formData, accepterat_pris: e.target.value})}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500"
                  />
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">Slutpris (kr)</label>
                  <input
                    type="number"
                    value={formData.slutpris}
                    onChange={(e) => setFormData({...formData, slutpris: e.target.value})}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500"
                  />
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">Pristyp</label>
                  <Select.Root value={formData.pristyp} onValueChange={(value: any) => setFormData({...formData, pristyp: value})}>
                    <Select.Trigger className="w-full flex items-center justify-between backdrop-blur-xl bg-white/30 border border-white/40 px-4 py-3 rounded-2xl">
                      <Select.Value />
                      <ChevronDown className="w-4 h-4" />
                    </Select.Trigger>
                    <Select.Portal>
                      <Select.Content className="backdrop-blur-xl bg-white/90 border border-white/40 rounded-2xl shadow-xl z-50">
                        <Select.Viewport className="p-2">
                          <Select.Item value="fast" className="px-4 py-2 rounded-xl hover:bg-white/50 cursor-pointer">
                            <Select.ItemText>Fast pris</Select.ItemText>
                          </Select.Item>
                          <Select.Item value="forhandling" className="px-4 py-2 rounded-xl hover:bg-white/50 cursor-pointer">
                            <Select.ItemText>F√∂rhandling</Select.ItemText>
                          </Select.Item>
                          <Select.Item value="budgivning" className="px-4 py-2 rounded-xl hover:bg-white/50 cursor-pointer">
                            <Select.ItemText>Budgivning</Select.ItemText>
                          </Select.Item>
                        </Select.Viewport>
                      </Select.Content>
                    </Select.Portal>
                  </Select.Root>
                </div>

                <div className="flex items-center space-x-3">
                  <input
                    type="checkbox"
                    id="budgivning"
                    checked={formData.budgivning}
                    onChange={(e) => setFormData({...formData, budgivning: e.target.checked})}
                    className="w-5 h-5 rounded border-white/40 bg-white/30 focus:ring-2 focus:ring-blue-500"
                  />
                  <label htmlFor="budgivning" className="text-sm font-medium text-gray-700">
                    Budgivning till√•ten
                  </label>
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">Budgivningsdatum</label>
                  <input
                    type="date"
                    value={formData.budgivningsdatum}
                    onChange={(e) => setFormData({...formData, budgivningsdatum: e.target.value})}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500"
                  />
                </div>

                <div className="md:col-span-3">
                  <label className="block text-sm font-medium text-gray-700 mb-2">Prisutveckling</label>
                  <textarea
                    value={formData.prisutveckling}
                    onChange={(e) => setFormData({...formData, prisutveckling: e.target.value})}
                    rows={3}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"
                    placeholder="Beskriv prisutveckling och marknadsf√∂rh√•llanden..."
                  />
                </div>
              </div>
            </GlassCard>

              {/* M√•nadsavgifter och kostnader */}
              <GlassCard className="p-6 mt-6">
              <div className="flex items-center space-x-3 mb-6">
                  <div className="w-10 h-10 bg-gradient-to-br from-yellow-500 to-orange-600 rounded-xl flex items-center justify-center">
                    <DollarSign className="w-5 h-5 text-white" />
                </div>
                  <h2 className="text-xl font-semibold text-gray-800">M√•nadsavgifter och kostnader</h2>
              </div>
              
              <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">M√•nadsavgift (kr)</label>
                  <input
                    type="number"
                      value={formData.manadsavgift}
                      onChange={(e) => setFormData({...formData, manadsavgift: e.target.value})}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500"
                  />
                </div>
                
                <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Kapitaltillskott (kr)</label>
                  <input
                    type="number"
                      value={formData.kapitaltillskott}
                      onChange={(e) => setFormData({...formData, kapitaltillskott: e.target.value})}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500"
                  />
                </div>
                
                <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Energikostnad/√•r (kr)</label>
                  <input
                    type="number"
                      value={formData.energikostnad_per_ar}
                      onChange={(e) => setFormData({...formData, energikostnad_per_ar: e.target.value})}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500"
                  />
                </div>

                  <div className="md:col-span-3">
                    <label className="block text-sm font-medium text-gray-700 mb-2">Vad innefattar avgiften</label>
                    <textarea
                      value={formData.avgift_innefattar}
                      onChange={(e) => setFormData({...formData, avgift_innefattar: e.target.value})}
                      rows={3}
                      className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"
                      placeholder="T.ex. V√§rme, vatten, el, bredband, kabel-TV, soph√§mtning..."
                    />
                  </div>
                </div>
              </GlassCard>
                </div>

            {/* L√ÖN OCH PANT - Ekonomi och drift */}
            <div ref={(el) => { sectionRefs.current['l√•n-och-pant'] = el }}>
              <GlassCard className="p-6">
                <div className="flex items-center space-x-3 mb-6">
                  <div className="w-10 h-10 bg-gradient-to-br from-emerald-500 to-green-600 rounded-xl flex items-center justify-center">
                    <DollarSign className="w-5 h-5 text-white" />
                  </div>
                  <h2 className="text-xl font-semibold text-gray-800">Ekonomi och drift</h2>
                </div>

                <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Driftkostnad (kr/√•r)</label>
                  <input
                    type="number"
                      value={formData.driftkostnad}
                      onChange={(e) => setFormData({...formData, driftkostnad: e.target.value})}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500"
                  />
                </div>
                
                <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Avgift (kr/m√•nad)</label>
                  <input
                    type="number"
                      value={formData.avgift}
                      onChange={(e) => setFormData({...formData, avgift: e.target.value})}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500"
                  />
                </div>

                <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Pantbrev (kr)</label>
                  <input
                    type="number"
                      value={formData.pantbrev}
                      onChange={(e) => setFormData({...formData, pantbrev: e.target.value})}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500"
                  />
                </div>

                <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Taxeringsv√§rde (kr)</label>
                  <input
                    type="number"
                      value={formData.taxeringsvarde}
                      onChange={(e) => setFormData({...formData, taxeringsvarde: e.target.value})}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500"
                  />
                </div>

                <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Kommunala avgifter (kr/√•r)</label>
                  <input
                    type="number"
                      value={formData.kommunala_avgifter}
                      onChange={(e) => setFormData({...formData, kommunala_avgifter: e.target.value})}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500"
                  />
                </div>

                <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">F√∂rs√§kringskostnad (kr/√•r)</label>
                  <input
                    type="number"
                      value={formData.forsakringskostnad}
                      onChange={(e) => setFormData({...formData, forsakringskostnad: e.target.value})}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500"
                  />
                  </div>
                </div>
              </GlassCard>
                </div>

            {/* BILDER */}
            <div ref={(el) => { sectionRefs.current['bilder'] = el }}>
              <GlassCard className="p-6">
                <div className="flex items-center space-x-3 mb-6">
                  <div className="w-10 h-10 bg-gradient-to-br from-pink-500 to-rose-600 rounded-xl flex items-center justify-center">
                    <Camera className="w-5 h-5 text-white" />
                </div>
                  <h2 className="text-xl font-semibold text-gray-800">Bilder</h2>
                </div>
                <div className="text-gray-600">
                  <p>Bildhantering kommer h√§r...</p>
              </div>
            </GlassCard>
            </div>

            {/* F√ñRENINGEN */}
            <div ref={(el) => { sectionRefs.current['foreningen'] = el }}>
              <GlassCard className="p-6">
                <div className="flex items-center space-x-3 mb-6">
                  <div className="w-10 h-10 bg-gradient-to-br from-teal-500 to-cyan-600 rounded-xl flex items-center justify-center">
                    <Building className="w-5 h-5 text-white" />
                  </div>
                  <h2 className="text-xl font-semibold text-gray-800">F√∂reningen</h2>
                </div>
                <div className="text-gray-600">
                  <p>Information om f√∂reningen kommer h√§r...</p>
                </div>
              </GlassCard>
            </div>

            {/* MARKNADSF√ñRING */}
            <div ref={(el) => { sectionRefs.current['marknadsf√∂ring'] = el }}>
              <GlassCard className="p-6">
                <div className="flex items-center space-x-3 mb-6">
                  <div className="w-10 h-10 bg-gradient-to-br from-emerald-500 to-green-600 rounded-xl flex items-center justify-center">
                    <Upload className="w-5 h-5 text-white" />
                  </div>
                  <h2 className="text-xl font-semibold text-gray-800">Marknadsf√∂ring</h2>
                </div>
                <div className="text-gray-600">
                  <p>Marknadsf√∂ringsaktiviteter kommer h√§r...</p>
                </div>
              </GlassCard>
            </div>

            {/* TJ√ÑNSTER */}
            <div ref={(el) => { sectionRefs.current['tj√§nster'] = el }}>
              <GlassCard className="p-6">
                <div className="flex items-center space-x-3 mb-6">
                  <div className="w-10 h-10 bg-gradient-to-br from-amber-500 to-yellow-600 rounded-xl flex items-center justify-center">
                    <Users className="w-5 h-5 text-white" />
                  </div>
                  <h2 className="text-xl font-semibold text-gray-800">Tj√§nster</h2>
                </div>
                <div className="text-gray-600">
                  <p>Tillh√∂rande tj√§nster kommer h√§r...</p>
                </div>
              </GlassCard>
            </div>

            {/* ATT G√ñRA */}
            <div ref={(el) => { sectionRefs.current['att-g√∂ra'] = el }}>
              <GlassCard className="p-6">
                <div className="flex items-center space-x-3 mb-6">
                  <div className="w-10 h-10 bg-gradient-to-br from-violet-500 to-purple-600 rounded-xl flex items-center justify-center">
                    <FileText className="w-5 h-5 text-white" />
                  </div>
                  <h2 className="text-xl font-semibold text-gray-800">Att g√∂ra</h2>
                </div>
                <div className="text-gray-600">
                  <p>Uppgifter och checklist kommer h√§r...</p>
                </div>
              </GlassCard>
            </div>

            {/* PARTER - Personer */}
            <div ref={(el) => { sectionRefs.current['parter'] = el }}>
            <GlassCard className="p-6">
              <div className="flex items-center space-x-3 mb-6">
                <div className="w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-600 rounded-xl flex items-center justify-center">
                  <Users className="w-5 h-5 text-white" />
                </div>
                <h2 className="text-xl font-semibold text-gray-800">Personer</h2>
              </div>
              
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">S√§ljare</label>
                <Select.Root value={formData.saljare_id} onValueChange={(value) => setFormData({...formData, saljare_id: value})}>
                  <Select.Trigger className="w-full flex items-center justify-between backdrop-blur-xl bg-white/30 border border-white/40 px-4 py-3 rounded-2xl">
                    <Select.Value placeholder="V√§lj s√§ljare" />
                    <ChevronDown className="w-4 h-4" />
                  </Select.Trigger>
                  <Select.Portal>
                    <Select.Content className="backdrop-blur-xl bg-white/90 border border-white/40 rounded-2xl shadow-xl z-50">
                      <Select.Viewport className="p-2 max-h-64 overflow-y-auto">
                                                 <Select.Item value="none" className="px-4 py-2 rounded-xl hover:bg-white/50 cursor-pointer">
                           <Select.ItemText>Ingen vald</Select.ItemText>
                         </Select.Item>
                        {kontakter.filter((k: any) => k.kategori === 'saljare').map((kontakt: any) => (
                          <Select.Item key={kontakt.id} value={kontakt.id} className="px-4 py-2 rounded-xl hover:bg-white/50 cursor-pointer">
                            <Select.ItemText>{kontakt.fornamn} {kontakt.efternamn}</Select.ItemText>
                          </Select.Item>
                        ))}
                      </Select.Viewport>
                    </Select.Content>
                  </Select.Portal>
                </Select.Root>
              </div>
            </GlassCard>
            </div>

            {/* SPEKULANTER - Placeholder f√∂r framtida funktionalitet */}
            <div ref={(el) => { sectionRefs.current['spekulanter'] = el }}>
            <GlassCard className="p-6">
              <div className="flex items-center space-x-3 mb-6">
                  <div className="w-10 h-10 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center">
                    <Users className="w-5 h-5 text-white" />
                </div>
                  <h2 className="text-xl font-semibold text-gray-800">Spekulanter</h2>
                </div>
                
                <div className="text-center py-8">
                  <p className="text-gray-500">Funktionalitet f√∂r hantering av spekulanter kommer att l√§ggas till h√§r.</p>
                </div>
              </GlassCard>
            </div>

            {/* TJ√ÑNSTER - Storlek och layout */}
            <div ref={(el) => { sectionRefs.current['tj√§nster'] = el }}>
              <GlassCard className="p-6">
                <div className="flex items-center space-x-3 mb-6">
                  <div className="w-10 h-10 bg-gradient-to-br from-green-500 to-teal-600 rounded-xl flex items-center justify-center">
                    <Home className="w-5 h-5 text-white" />
                  </div>
                  <h2 className="text-xl font-semibold text-gray-800">Storlek och layout</h2>
              </div>
              
              <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Boarea (m¬≤)</label>
                  <input
                    type="number"
                      value={formData.boarea}
                      onChange={(e) => setFormData({...formData, boarea: e.target.value})}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500"
                  />
                </div>

                <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Biarea (m¬≤)</label>
                  <input
                    type="number"
                      value={formData.biarea}
                      onChange={(e) => setFormData({...formData, biarea: e.target.value})}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500"
                  />
                </div>

                <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Tomtarea (m¬≤)</label>
                  <input
                    type="number"
                      value={formData.tomtarea}
                      onChange={(e) => setFormData({...formData, tomtarea: e.target.value})}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500"
                  />
                </div>

                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">K√§llararea (m¬≤)</label>
                    <input
                      type="number"
                      value={formData.kallare_area}
                      onChange={(e) => setFormData({...formData, kallare_area: e.target.value})}
                      className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500"
                  />
                </div>

                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Garagearea (m¬≤)</label>
                    <input
                      type="number"
                      value={formData.garage_area}
                      onChange={(e) => setFormData({...formData, garage_area: e.target.value})}
                      className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500"
                    />
              </div>

                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Bygg√•r</label>
                    <input
                      type="number"
                      value={formData.byggaar}
                      onChange={(e) => setFormData({...formData, byggaar: e.target.value})}
                      className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500"
                    />
              </div>
              
                <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Antal rum</label>
                  <input
                    type="number"
                      value={formData.rum}
                      onChange={(e) => setFormData({...formData, rum: e.target.value})}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500"
                  />
                </div>
                
                <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Antal sovrum</label>
                  <input
                    type="number"
                      value={formData.antal_sovrum}
                      onChange={(e) => setFormData({...formData, antal_sovrum: e.target.value})}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500"
                  />
                </div>

                <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Antal WC</label>
                  <input
                    type="number"
                      value={formData.antal_wc}
                      onChange={(e) => setFormData({...formData, antal_wc: e.target.value})}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500"
                  />
                </div>

                <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">V√•ning</label>
                  <input
                    type="number"
                      value={formData.vaning}
                      onChange={(e) => setFormData({...formData, vaning: e.target.value})}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500"
                  />
                </div>

                <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Antal v√•ningar hus</label>
                  <input
                    type="number"
                      value={formData.antal_vaningar_hus}
                      onChange={(e) => setFormData({...formData, antal_vaningar_hus: e.target.value})}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500"
                  />
                </div>

                <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">K√∂ksstorlek (m¬≤)</label>
                  <input
                    type="number"
                      value={formData.koksstorlek}
                      onChange={(e) => setFormData({...formData, koksstorlek: e.target.value})}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500"
                  />
                </div>
              </div>
            </GlassCard>

            {/* Energicertifiering */}
              <GlassCard className="p-6 mt-6">
              <div className="flex items-center space-x-3 mb-6">
                <div className="w-10 h-10 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl flex items-center justify-center">
                  <Building className="w-5 h-5 text-white" />
                </div>
                <h2 className="text-xl font-semibold text-gray-800">Energicertifiering</h2>
              </div>
              
              <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">Energiklass</label>
                  <Select.Root value={formData.energiklass} onValueChange={(value: 'A' | 'B' | 'C' | 'D' | 'E' | 'F' | 'G') => setFormData({...formData, energiklass: value})}>
                    <Select.Trigger className="w-full flex items-center justify-between backdrop-blur-xl bg-white/30 border border-white/40 px-4 py-3 rounded-2xl">
                      <Select.Value placeholder="V√§lj energiklass" />
                      <ChevronDown className="w-4 h-4" />
                    </Select.Trigger>
                    <Select.Portal>
                      <Select.Content className="backdrop-blur-xl bg-white/90 border border-white/40 rounded-2xl shadow-xl z-50">
                        <Select.Viewport className="p-2">
                          <Select.Item value="A" className="px-4 py-2 rounded-xl hover:bg-white/50 cursor-pointer">
                            <Select.ItemText>A</Select.ItemText>
                          </Select.Item>
                          <Select.Item value="B" className="px-4 py-2 rounded-xl hover:bg-white/50 cursor-pointer">
                            <Select.ItemText>B</Select.ItemText>
                          </Select.Item>
                          <Select.Item value="C" className="px-4 py-2 rounded-xl hover:bg-white/50 cursor-pointer">
                            <Select.ItemText>C</Select.ItemText>
                          </Select.Item>
                          <Select.Item value="D" className="px-4 py-2 rounded-xl hover:bg-white/50 cursor-pointer">
                            <Select.ItemText>D</Select.ItemText>
                          </Select.Item>
                          <Select.Item value="E" className="px-4 py-2 rounded-xl hover:bg-white/50 cursor-pointer">
                            <Select.ItemText>E</Select.ItemText>
                          </Select.Item>
                          <Select.Item value="F" className="px-4 py-2 rounded-xl hover:bg-white/50 cursor-pointer">
                            <Select.ItemText>F</Select.ItemText>
                          </Select.Item>
                          <Select.Item value="G" className="px-4 py-2 rounded-xl hover:bg-white/50 cursor-pointer">
                            <Select.ItemText>G</Select.ItemText>
                          </Select.Item>
                        </Select.Viewport>
                      </Select.Content>
                    </Select.Portal>
                  </Select.Root>
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">Energiprestanda (kWh/m¬≤/√•r)</label>
                  <input
                    type="number"
                    value={formData.energiprestanda}
                    onChange={(e) => setFormData({...formData, energiprestanda: e.target.value})}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500"
                  />
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">Certifikatnummer</label>
                  <input
                    type="text"
                    value={formData.energicertifikat_nummer}
                    onChange={(e) => setFormData({...formData, energicertifikat_nummer: e.target.value})}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500"
                  />
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">Utf√§rdad datum</label>
                  <input
                    type="date"
                    value={formData.energicertifikat_utfardad}
                    onChange={(e) => setFormData({...formData, energicertifikat_utfardad: e.target.value})}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500"
                  />
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">Giltig till</label>
                  <input
                    type="date"
                    value={formData.energicertifikat_giltig_till}
                    onChange={(e) => setFormData({...formData, energicertifikat_giltig_till: e.target.value})}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500"
                  />
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">Energideklaration URL</label>
                  <input
                    type="url"
                    value={formData.energideklaration_url}
                    onChange={(e) => setFormData({...formData, energideklaration_url: e.target.value})}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500"
                    placeholder="https://..."
                  />
                </div>
              </div>
            </GlassCard>

            {/* Tekniska detaljer */}
              <GlassCard className="p-6 mt-6">
              <div className="flex items-center space-x-3 mb-6">
                <div className="w-10 h-10 bg-gradient-to-br from-cyan-500 to-blue-600 rounded-xl flex items-center justify-center">
                  <Building className="w-5 h-5 text-white" />
                </div>
                <h2 className="text-xl font-semibold text-gray-800">Tekniska detaljer</h2>
              </div>
              
              <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">Byggmaterial</label>
                  <Select.Root value={formData.byggmaterial} onValueChange={(value: 'tegel' | 'trak' | 'betong' | 'puts' | 'panel' | 'natursten' | 'annat') => setFormData({...formData, byggmaterial: value})}>
                    <Select.Trigger className="w-full flex items-center justify-between backdrop-blur-xl bg-white/30 border border-white/40 px-4 py-3 rounded-2xl">
                      <Select.Value placeholder="V√§lj byggmaterial" />
                      <ChevronDown className="w-4 h-4" />
                    </Select.Trigger>
                    <Select.Portal>
                      <Select.Content className="backdrop-blur-xl bg-white/90 border border-white/40 rounded-2xl shadow-xl z-50">
                        <Select.Viewport className="p-2">
                          <Select.Item value="tegel" className="px-4 py-2 rounded-xl hover:bg-white/50 cursor-pointer">
                            <Select.ItemText>Tegel</Select.ItemText>
                          </Select.Item>
                          <Select.Item value="trak" className="px-4 py-2 rounded-xl hover:bg-white/50 cursor-pointer">
                            <Select.ItemText>Tr√§</Select.ItemText>
                          </Select.Item>
                          <Select.Item value="betong" className="px-4 py-2 rounded-xl hover:bg-white/50 cursor-pointer">
                            <Select.ItemText>Betong</Select.ItemText>
                          </Select.Item>
                          <Select.Item value="puts" className="px-4 py-2 rounded-xl hover:bg-white/50 cursor-pointer">
                            <Select.ItemText>Puts</Select.ItemText>
                          </Select.Item>
                          <Select.Item value="panel" className="px-4 py-2 rounded-xl hover:bg-white/50 cursor-pointer">
                            <Select.ItemText>Panel</Select.ItemText>
                          </Select.Item>
                          <Select.Item value="natursten" className="px-4 py-2 rounded-xl hover:bg-white/50 cursor-pointer">
                            <Select.ItemText>Natursten</Select.ItemText>
                          </Select.Item>
                          <Select.Item value="annat" className="px-4 py-2 rounded-xl hover:bg-white/50 cursor-pointer">
                            <Select.ItemText>Annat</Select.ItemText>
                          </Select.Item>
                        </Select.Viewport>
                      </Select.Content>
                    </Select.Portal>
                  </Select.Root>
                </div>
                
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">Uppv√§rmning</label>
                  <Select.Root value={formData.uppvarmning} onValueChange={(value: 'fj√§rrv√§rme' | 'elv√§rme' | 'pelletsbr√§nnare' | 'vedeldning' | 'olja' | 'gas' | 'bergv√§rme' | 'luftv√§rmepump' | 'annat') => setFormData({...formData, uppvarmning: value})}>
                    <Select.Trigger className="w-full flex items-center justify-between backdrop-blur-xl bg-white/30 border border-white/40 px-4 py-3 rounded-2xl">
                      <Select.Value placeholder="V√§lj uppv√§rmning" />
                      <ChevronDown className="w-4 h-4" />
                    </Select.Trigger>
                    <Select.Portal>
                      <Select.Content className="backdrop-blur-xl bg-white/90 border border-white/40 rounded-2xl shadow-xl z-50">
                        <Select.Viewport className="p-2 max-h-64 overflow-y-auto">
                          <Select.Item value="fj√§rrv√§rme" className="px-4 py-2 rounded-xl hover:bg-white/50 cursor-pointer">
                            <Select.ItemText>Fj√§rrv√§rme</Select.ItemText>
                          </Select.Item>
                          <Select.Item value="bergv√§rme" className="px-4 py-2 rounded-xl hover:bg-white/50 cursor-pointer">
                            <Select.ItemText>Bergv√§rme</Select.ItemText>
                          </Select.Item>
                          <Select.Item value="luftv√§rmepump" className="px-4 py-2 rounded-xl hover:bg-white/50 cursor-pointer">
                            <Select.ItemText>Luftv√§rmepump</Select.ItemText>
                          </Select.Item>
                          <Select.Item value="elv√§rme" className="px-4 py-2 rounded-xl hover:bg-white/50 cursor-pointer">
                            <Select.ItemText>Elv√§rme</Select.ItemText>
                          </Select.Item>
                          <Select.Item value="pelletsbr√§nnare" className="px-4 py-2 rounded-xl hover:bg-white/50 cursor-pointer">
                            <Select.ItemText>Pelletsbr√§nnare</Select.ItemText>
                          </Select.Item>
                          <Select.Item value="vedeldning" className="px-4 py-2 rounded-xl hover:bg-white/50 cursor-pointer">
                            <Select.ItemText>Vedeldning</Select.ItemText>
                          </Select.Item>
                          <Select.Item value="olja" className="px-4 py-2 rounded-xl hover:bg-white/50 cursor-pointer">
                            <Select.ItemText>Olja</Select.ItemText>
                          </Select.Item>
                          <Select.Item value="gas" className="px-4 py-2 rounded-xl hover:bg-white/50 cursor-pointer">
                            <Select.ItemText>Gas</Select.ItemText>
                          </Select.Item>
                          <Select.Item value="annat" className="px-4 py-2 rounded-xl hover:bg-white/50 cursor-pointer">
                            <Select.ItemText>Annat</Select.ItemText>
                          </Select.Item>
                        </Select.Viewport>
                      </Select.Content>
                    </Select.Portal>
                  </Select.Root>
                </div>
                
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">Internet</label>
                  <input
                    type="text"
                    value={formData.internet}
                    onChange={(e) => setFormData({...formData, internet: e.target.value})}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500"
                    placeholder="T.ex. Fiber, ADSL"
                  />
                </div>
              </div>
            </GlassCard>
            </div>

            {/* BESKRIVNINGAR */}
            <div ref={(el) => { sectionRefs.current['beskrivningar'] = el }}>
            <GlassCard className="p-6">
              <div className="flex items-center space-x-3 mb-6">
                  <div className="w-10 h-10 bg-gradient-to-br from-indigo-500 to-blue-600 rounded-xl flex items-center justify-center">
                  <FileText className="w-5 h-5 text-white" />
                </div>
                  <h2 className="text-xl font-semibold text-gray-800">Beskrivningar och marknadsf√∂ring</h2>
              </div>
              
                <div className="space-y-6">
                <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Allm√§n beskrivning</label>
                  <textarea
                      value={formData.beskrivning}
                      onChange={(e) => setFormData({...formData, beskrivning: e.target.value})}
                      rows={4}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"
                      placeholder="Allm√§n beskrivning av objektet..."
                  />
                </div>
                
                <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">M√§klartext</label>
                  <textarea
                      value={formData.maklartext}
                      onChange={(e) => setFormData({...formData, maklartext: e.target.value})}
                      rows={4}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"
                      placeholder="Professionell beskrivning f√∂r marknadsf√∂ring..."
                  />
                </div>

                <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">S√§ljtext</label>
                  <textarea
                      value={formData.salutext}
                      onChange={(e) => setFormData({...formData, salutext: e.target.value})}
                    rows={3}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"
                      placeholder="S√§ljarens egen beskrivning..."
                  />
                </div>

                <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Marknadsf√∂ringstext</label>
                  <textarea
                      value={formData.marknadsforingstext}
                      onChange={(e) => setFormData({...formData, marknadsforingstext: e.target.value})}
                    rows={3}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"
                      placeholder="Text f√∂r marknadsf√∂ring och annonser..."
                  />
                </div>
              </div>
            </GlassCard>

              {/* Tillbeh√∂r och ing√•ende */}
              <GlassCard className="p-6 mt-6">
                <div className="flex items-center space-x-3 mb-6">
                  <div className="w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-600 rounded-xl flex items-center justify-center">
                    <FileText className="w-5 h-5 text-white" />
                  </div>
                  <h2 className="text-xl font-semibold text-gray-800">Tillbeh√∂r och ing√•ende</h2>
                </div>
                
                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Tillbeh√∂r som ing√•r</label>
                    <textarea
                      value={formData.tillbehor_som_ingaar}
                      onChange={(e) => setFormData({...formData, tillbehor_som_ingaar: e.target.value})}
                      rows={4}
                      className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"
                      placeholder="Lista vad som ing√•r i f√∂rs√§ljningen..."
                    />
                  </div>

                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Tillbeh√∂r som ej ing√•r</label>
                    <textarea
                      value={formData.tillbehor_som_ej_ingaar}
                      onChange={(e) => setFormData({...formData, tillbehor_som_ej_ingaar: e.target.value})}
                      rows={4}
                      className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"
                      placeholder="Lista vad som ej ing√•r i f√∂rs√§ljningen..."
                    />
                  </div>
                </div>
              </GlassCard>
            </div>

            {/* MARKNADSF√ñRING - Visning och marknadsf√∂ring */}
            <div ref={(el) => { sectionRefs.current['marknadsf√∂ring'] = el }}>
            <GlassCard className="p-6">
              <div className="flex items-center space-x-3 mb-6">
                <div className="w-10 h-10 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl flex items-center justify-center">
                  <MapPin className="w-5 h-5 text-white" />
                </div>
                <h2 className="text-xl font-semibold text-gray-800">Visning och marknadsf√∂ring</h2>
              </div>
              
              <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">Tilltr√§desdatum</label>
                  <input
                    type="date"
                    value={formData.tillgangsdatum}
                    onChange={(e) => setFormData({...formData, tillgangsdatum: e.target.value})}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500"
                  />
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">Listningsdatum</label>
                  <input
                    type="date"
                    value={formData.listningsdatum}
                    onChange={(e) => setFormData({...formData, listningsdatum: e.target.value})}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500"
                  />
                </div>
                
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">Visningsinformation</label>
                  <input
                    type="text"
                    value={formData.visningsinfo}
                    onChange={(e) => setFormData({...formData, visningsinfo: e.target.value})}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500"
                    placeholder="T.ex. Efter √∂verenskommelse"
                  />
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">Visningsdagar</label>
                  <input
                    type="text"
                    value={formData.visningsdagar}
                    onChange={(e) => setFormData({...formData, visningsdagar: e.target.value})}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500"
                    placeholder="T.ex. M√•ndag-fredag 18-19"
                  />
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">√ñppet hus</label>
                  <input
                    type="text"
                    value={formData.oppet_hus}
                    onChange={(e) => setFormData({...formData, oppet_hus: e.target.value})}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500"
                    placeholder="T.ex. S√∂ndag 14-15"
                  />
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">Avtalsdatum</label>
                  <input
                    type="date"
                    value={formData.avtal_datum}
                    onChange={(e) => setFormData({...formData, avtal_datum: e.target.value})}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500"
                  />
                </div>

                <div className="md:col-span-2">
                  <label className="block text-sm font-medium text-gray-700 mb-2">Detaljerade visningsdagar</label>
                  <textarea
                    value={formData.visningsdagar_detaljer}
                    onChange={(e) => setFormData({...formData, visningsdagar_detaljer: e.target.value})}
                    rows={3}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"
                    placeholder="Detaljerad information om visningsdagar och tider..."
                  />
                </div>
              </div>
            </GlassCard>

            {/* Omr√•de och tillg√§nglighet */}
              <GlassCard className="p-6 mt-6">
              <div className="flex items-center space-x-3 mb-6">
                <div className="w-10 h-10 bg-gradient-to-br from-blue-500 to-cyan-600 rounded-xl flex items-center justify-center">
                  <MapPin className="w-5 h-5 text-white" />
                </div>
                <h2 className="text-xl font-semibold text-gray-800">Omr√•de och tillg√§nglighet</h2>
              </div>
              
              <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">Kollektivtrafik</label>
                  <textarea
                    value={formData.kollektivtrafik}
                    onChange={(e) => setFormData({...formData, kollektivtrafik: e.target.value})}
                    rows={3}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"
                    placeholder="Beskriv n√§rhet till kollektivtrafik..."
                  />
                </div>
                
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">Parkering</label>
                  <textarea
                    value={formData.parkering}
                    onChange={(e) => setFormData({...formData, parkering: e.target.value})}
                    rows={3}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"
                    placeholder="Beskriv parkeringsm√∂jligheter..."
                  />
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">Antal parkeringsplatser</label>
                  <input
                    type="number"
                    value={formData.antal_parkeringsplatser}
                    onChange={(e) => setFormData({...formData, antal_parkeringsplatser: e.target.value})}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500"
                  />
                </div>
              </div>
            </GlassCard>
            </div>

            {/* DOKUMENT - Dokument och media */}
            <div ref={(el) => { sectionRefs.current['dokument'] = el }}>
            <GlassCard className="p-6">
              <div className="flex items-center space-x-3 mb-6">
                  <div className="w-10 h-10 bg-gradient-to-br from-teal-500 to-cyan-600 rounded-xl flex items-center justify-center">
                    <Camera className="w-5 h-5 text-white" />
                </div>
                  <h2 className="text-xl font-semibold text-gray-800">Dokument och media</h2>
              </div>
              
              <div className="space-y-6">
                <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Planritning URL</label>
                    <input
                      type="url"
                      value={formData.planritning_url}
                      onChange={(e) => setFormData({...formData, planritning_url: e.target.value})}
                      className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500"
                      placeholder="https://..."
                  />
                </div>

                <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Byggnadsbeskrivning URL</label>
                    <input
                      type="url"
                      value={formData.byggnadsbeskrivning_url}
                      onChange={(e) => setFormData({...formData, byggnadsbeskrivning_url: e.target.value})}
                      className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500"
                      placeholder="https://..."
                  />
                </div>
                </div>
              </GlassCard>

              {/* Juridiska aspekter */}
              <GlassCard className="p-6 mt-6">
                <div className="flex items-center space-x-3 mb-6">
                  <div className="w-10 h-10 bg-gradient-to-br from-red-500 to-pink-600 rounded-xl flex items-center justify-center">
                    <FileText className="w-5 h-5 text-white" />
                  </div>
                  <h2 className="text-xl font-semibold text-gray-800">Juridiska aspekter</h2>
                </div>
                
                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Servitut</label>
                  <textarea
                      value={formData.servitut}
                      onChange={(e) => setFormData({...formData, servitut: e.target.value})}
                    rows={3}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"
                      placeholder="Beskriv eventuella servitut..."
                  />
                </div>

                <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Inskr√§nkningar</label>
                  <textarea
                      value={formData.inskrankning}
                      onChange={(e) => setFormData({...formData, inskrankning: e.target.value})}
                    rows={3}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"
                      placeholder="Beskriv eventuella inskr√§nkningar..."
                  />
                </div>

                <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Belastningar</label>
                  <textarea
                      value={formData.belastningar}
                      onChange={(e) => setFormData({...formData, belastningar: e.target.value})}
                      rows={3}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"
                      placeholder="Beskriv eventuella belastningar..."
                  />
                </div>

                <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Gemensamhetsanl√§ggning</label>
                  <textarea
                      value={formData.gemensamhetsanlaggning}
                      onChange={(e) => setFormData({...formData, gemensamhetsanlaggning: e.target.value})}
                      rows={3}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"
                      placeholder="Beskriv andel i gemensamhetsanl√§ggning..."
                  />
                </div>
              </div>
            </GlassCard>
            </div>

            {/* BILDER - Bildhantering */}
            <div ref={(el) => { sectionRefs.current['bilder'] = el }}>
            <GlassCard className="p-6">
              <div className="flex items-center space-x-3 mb-6">
                  <div className="w-10 h-10 bg-gradient-to-br from-pink-500 to-purple-600 rounded-xl flex items-center justify-center">
                  <Camera className="w-5 h-5 text-white" />
                </div>
                  <h2 className="text-xl font-semibold text-gray-800">Bilder och media</h2>
                </div>

                <div className="border-2 border-dashed border-white/40 rounded-2xl p-8 text-center">
                  <Upload className="w-12 h-12 text-gray-400 mx-auto mb-4" />
                  <p className="text-gray-600 mb-2">Dra och sl√§pp bilder h√§r</p>
                  <p className="text-sm text-gray-500">eller</p>
                  <button type="button" className="mt-2 text-blue-600 hover:text-blue-700 font-medium">
                    V√§lj filer
                  </button>
                </div>
              </GlassCard>
            </div>

            {/* F√ñRENINGEN - Placeholder f√∂r framtida funktionalitet */}
            <div ref={(el) => { sectionRefs.current['foreningen'] = el }}>
              <GlassCard className="p-6">
                <div className="flex items-center space-x-3 mb-6">
                  <div className="w-10 h-10 bg-gradient-to-br from-amber-500 to-orange-600 rounded-xl flex items-center justify-center">
                    <Building className="w-5 h-5 text-white" />
                  </div>
                  <h2 className="text-xl font-semibold text-gray-800">F√∂reningen</h2>
                </div>
                
                <div className="text-center py-8">
                  <p className="text-gray-500">Funktionalitet f√∂r f√∂reningshantering kommer att l√§ggas till h√§r.</p>
              </div>
            </GlassCard>
            </div>

            {/* ATT G√ñRA - √ñvrigt och anm√§rkningar */}
            <div ref={(el) => { sectionRefs.current['att-g√∂ra'] = el }}>
            <GlassCard className="p-6">
              <div className="flex items-center space-x-3 mb-6">
                <div className="w-10 h-10 bg-gradient-to-br from-gray-500 to-slate-600 rounded-xl flex items-center justify-center">
                  <FileText className="w-5 h-5 text-white" />
                </div>
                <h2 className="text-xl font-semibold text-gray-800">√ñvrigt och anm√§rkningar</h2>
              </div>
              
              <div className="space-y-6">
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">Specialbest√§mmelser</label>
                  <textarea
                    value={formData.specialbestammelser}
                    onChange={(e) => setFormData({...formData, specialbestammelser: e.target.value})}
                    rows={4}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"
                    placeholder="Eventuella specialbest√§mmelser..."
                  />
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">Anm√§rkningar</label>
                  <textarea
                    value={formData.anmarkningar}
                    onChange={(e) => setFormData({...formData, anmarkningar: e.target.value})}
                    rows={4}
                    className="w-full px-4 py-3 backdrop-blur-xl bg-white/30 border border-white/40 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"
                    placeholder="√ñvriga anm√§rkningar och noteringar..."
                  />
                </div>
              </div>
            </GlassCard>
            </div>

            {/* Actions */}
            <div className="flex justify-end space-x-4">
              <Link href="/objekt" className="px-6 py-3 backdrop-blur-xl bg-white/30 border border-white/40 text-gray-700 rounded-2xl font-medium hover:bg-white/40 transition-all duration-300">
                Avbryt
              </Link>
              <button
                type="submit"
                disabled={createObjekt.isPending}
                className="flex items-center space-x-2 bg-gradient-to-r from-blue-500 to-purple-600 text-white px-6 py-3 rounded-2xl font-medium hover:from-blue-600 hover:to-purple-700 transition-all duration-300 shadow-lg hover:shadow-xl disabled:opacity-50"
              >
                <Save className="w-5 h-5" />
                <span>{createObjekt.isPending ? 'Sparar...' : 'Spara objekt'}</span>
              </button>
            </div>
              </form>
            </div>
          </div>
        </div>
    </DashboardLayout>
  )
} 